const util={diffDate:(t,e=!1)=>{const o=new Date,n=new Date(t),c=o.getTime()-n.getTime(),s=1e3*60,i=s*60,r=i*24;let a;if(e){const d=c/r,u=c/i,h=c/s;d>14?a=null:d>=1?a=parseInt(d)+" "+ctx.date_suffix.day:u>=1?a=parseInt(u)+" "+ctx.date_suffix.hour:h>=1?a=parseInt(h)+" "+ctx.date_suffix.min:a=ctx.date_suffix.just}else a=parseInt(c/r);return a},copy:(t,e)=>{const o=document.getElementById(t);o&&(o.select(),document.execCommand("Copy"),e&&e.length>0&&hud.toast(e,2500))},toggle:t=>{const e=document.getElementById(t);e&&e.classList.toggle("display")},scrollTop:()=>{window.scrollTo({top:0,behavior:"smooth"})},scrollComment:()=>{document.getElementById("comments").scrollIntoView({behavior:"smooth"})},viewportLazyload:(t,e,o=!0)=>{if(!o||!("IntersectionObserver"in window)){e();return}const n=new IntersectionObserver(c=>{c[0].intersectionRatio>0&&(e(),n.disconnect())});n.observe(t)}},hud={toast:(t,e)=>{const o=Number(isNaN(e)?2e3:e);var n=document.createElement("div");n.classList.add("toast"),n.classList.add("show"),n.innerHTML=t,document.body.appendChild(n),setTimeout(function(){document.body.removeChild(n)},o)}},l_body=document.querySelector(".l_body"),init={toc:()=>{utils.jq(()=>{var e=[];$("article.md-text :header").each(function(s,i){e.push(i)});function o(){var s=$(this).scrollTop(),i=null;for(var r in e){var a=$(e[r]);a.offset().top>s+32||(i?a.offset().top>=i.offset().top&&(i=a):i=a)}if(i){$("#data-toc a.toc-link").removeClass("active");var d="#"+i.attr("id");if(d!="#undefined"){const u=$('#data-toc a.toc-link[href="'+encodeURI(d)+'"]');u.length>0&&u.addClass("active")}else $("#data-toc a.toc-link:first").addClass("active")}}function n(){const s=document.querySelector("#data-toc .toc"),i=document.querySelector("#data-toc .toc a.toc-link.active");if(s==null||i==null)return;const r=i.getBoundingClientRect().bottom-s.getBoundingClientRect().bottom+100,a=i.getBoundingClientRect().top-s.getBoundingClientRect().top-64;a<0?s.scrollBy({top:a,behavior:"smooth"}):r>0&&s.scrollBy({top:r,behavior:"smooth"})}var c=null;window.addEventListener("scroll",function(){o(),c!==null&&clearTimeout(c),c=setTimeout(function(){n()}.bind(this),50)})})},sidebar:()=>{utils.jq(()=>{$("#data-toc a.toc-link").click(function(t){sidebar.dismiss()})})},relativeDate:t=>{t.forEach(e=>{const o=e,n=o.getAttribute("datetime");let c=util.diffDate(n,!0);c&&(o.innerText=c)})},registerTabsTag:function(){document.querySelectorAll(".tabs .nav-tabs .tab").forEach(t=>{t.addEventListener("click",e=>{if(e.preventDefault(),t.classList.contains("active"))return;[...t.parentNode.children].forEach(n=>{n.classList.toggle("active",n===t)});const o=document.getElementById(t.querySelector("a").getAttribute("href").replace("#",""));[...o.parentNode.children].forEach(n=>{n.classList.toggle("active",n===o)}),o.dispatchEvent(new Event("tabs:click",{bubbles:!0}))})}),window.dispatchEvent(new Event("tabs:register"))},canonicalCheck:()=>{const t=window.canonical;function e(){return new Promise(f=>{if(window.canonical.originalHost===window.location.hostname){f(!0);return}const m=`https://${window.canonical.originalHost}${window.canonical.param.checklink}`,l=document.createElement("script");l.src=m,l.type="text/javascript",l.onload=function(){f(!0)},l.onerror=function(){f(!1)},document.head.appendChild(l)})}async function o(f=!1){const m=document.createElement("meta");m.name="robots",m.content="noindex, nofollow",document.head.appendChild(m);const l=document.createElement("div"),p=`https://${t.originalHost}`,w=t.param.permalink.startsWith("http")?t.param.permalink:p;if(f){const b=window.localStorage.getItem("Stellar.canonical.closeEnable")==="true",v=window.localStorage.getItem("Stellar.canonical.closeTime")===new Date().toDateString();if(b&&v||!await e())return;l.className="canonical-tip official",l.innerHTML=`
          <a href="${w}" target="_self" rel="noopener noreferrer">
          \u672C\u7AD9\u4E3A\u5B98\u65B9\u5907\u7528\u7AD9\uFF0C\u4EC5\u4F9B\u5E94\u6025\u3002\u70B9\u51FB\u79FB\u6B65\u4E3B\u7AD9<br>${p}
          </a>
          ${t.closeEnable?'<button id="canonical-close">'+t.closeText||"\u5173\u95ED\u63D0\u793A</button>":""}
        `}else l.className="canonical-tip unofficial",l.innerHTML=`
        <a href="${w}" target="_self" rel="noopener noreferrer">
        <div class="headline icon">\u2620\uFE0F</div>
        \u672C\u7AD9\u4E3A\u975E\u6CD5\u514B\u9686\u7AD9\uFF0C\u8BF7\u524D\u5F80\u5B98\u65B9\u6E90\u7AD9\u8BBF\u95EE\u3002<br>
        \u6E90\u7AD9\uFF1A${p}
        </a>
        `;document.body.appendChild(l);const g=l.querySelector("#canonical-close");g&&g.addEventListener("click",function(){window.localStorage.setItem("Stellar.canonical.closeEnable","true"),window.localStorage.setItem("Stellar.canonical.closeTime",new Date().toDateString()),l.style.display="none"})}if(!t.originalHost)return;const c=new URL(window.location.href).hostname.replace(/^www\./,"");if(c=="localhost")return;const s=window.btoa(c),i=t.encoded===s,r=document.querySelector('link[rel="canonical"]');if(!r){if(i)return;if(t.officialHosts?.includes(c)){o(!0);return}o(!1);return}const d=new URL(r.href).hostname.replace(/^www\./,""),u=window.btoa(d);t.encoded===u&&i||o(t.officialHosts?.includes(c))}};init.toc(),init.sidebar(),init.relativeDate(document.querySelectorAll("#post-meta time")),init.registerTabsTag(),init.canonicalCheck();
