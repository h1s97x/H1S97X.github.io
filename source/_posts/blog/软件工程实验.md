---
title: 软件工程实验
categories:
  - null
date: 2023-09-20 09:04:41
updated: 2023-09-20 09:04:41
tags:
---

[利用GAN生成动漫头像_gan网络实现动漫头像-CSDN博客](https://blog.csdn.net/qq_34739497/article/details/79902356)

[GAN学习指南：从原理入门到制作生成Demo - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/24767059)

### 课题选择

做点前沿的课题
- 图像/视频 异常监测、实时异常监测
- Applied Machine Learning、Deep Learning、Computer Vision、Pattern Recognition、AI、FL、AIGC
- 人脸识别、物体识别、行为识别
- AI生成

### GAN 对抗生成网络

说到GAN第一篇要看的paper当然是Lan Goodfellow大牛的[Generative Adversarial Networks](https://arxiv.org/abs/1406.2661)，这篇paper算是这个领域的开山之作。

#### 代码实现

- 原始数据集的搜集

爬取动漫图库网站：[konachan.net - Konachan.com Anime Wallpapers](http://konachan.net/post?page=3&tags=)。

- 数据处理

由于这些图片比较复杂，对于网络难以训练，我们需要截取出动漫人物的头像，通过opencv工具，github上面已经有这个项目应用，[nagadomi/lbpcascade_animeface](https://github.com/nagadomi/lbpcascade_animeface)

```
import cv2#需提前在你的python环境下安装opencv包
import sys
import os.path
from glob import glob

def detect(filename, cascade_file="lbpcascade_animeface.xml"):
    if not os.path.isfile(cascade_file):#lbpcascade_animeface.xml文件可在github上面找到，就是一个巨长的xml格式代码，表示看不懂。
        raise RuntimeError("%s: not found" % cascade_file)

    cascade = cv2.CascadeClassifier(cascade_file)
    image = cv2.imread(filename)
    gray = cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)
    gray = cv2.equalizeHist(gray)

    faces = cascade.detectMultiScale(gray,
                                     # detector options
                                     scaleFactor=1.1,
                                     minNeighbors=5,
                                     minSize=(48, 48))
    for i, (x, y, w, h) in enumerate(faces):
        face = image[y: y + h, x:x + w, :]
        face = cv2.resize(face, (96, 96))
        save_filename = '%s-%d.jpg' % (os.path.basename(filename).split('.')[0], i)
        cv2.imwrite("faces/" + save_filename, face)#写入文件


if __name__ == '__main__':
    if os.path.exists('faces') is False:
        os.makedirs('faces')
    file_list = glob('imgs/*.jpg')
    for filename in file_list:
        detect(filename)

```



- 训练图像

DCGAN在Tensorflow中已经有人造好了轮子：[carpedm20/DCGAN-tensorflow](https://link.zhihu.com/?target=https%3A//github.com/carpedm20/DCGAN-tensorflow)，我们直接使用这个代码就可以了。

不过原始代码中只提供了有限的几个数据库，如何训练自己的数据？在model.py中我们找到读数据的几行代码：

```python
 if config.dataset == 'mnist':
            data_X, data_y = self.load_mnist()
        else:
            data = glob(os.path.join("./data", config.dataset, "*.jpg"))
```

这样读数据的逻辑就很清楚了，我们在data文件夹中再新建一个anime文件夹，把图片直接放到这个文件夹里，运行时指定--dataset anime即可。

运行指令（参数含义：指定生成的图片的尺寸为48x48，我们图片的大小是96x96，跑300个epoch）：

```bash
python main.py --image_size 96 --output_size 48 --dataset anime --is_crop True --is_train True --epoch 300 --input_fname_pattern "*.jpg"
```

**4. 结果**
