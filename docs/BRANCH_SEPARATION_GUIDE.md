# å¼€å‘å†…å®¹ä¸éƒ¨ç½²å†…å®¹åˆ†ç¦»æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•å®‰å…¨åœ°å°†Hexoåšå®¢é¡¹ç›®çš„æºç å’Œç”Ÿæˆæ–‡ä»¶åˆ†ç¦»åˆ°ä¸åŒçš„Gitåˆ†æ”¯ï¼Œå®ç°æ›´æ¸…æ™°çš„é¡¹ç›®ç®¡ç†å’Œè‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚

## ğŸ¯ ç›®æ ‡

- **æºç åˆ†æ”¯ï¼ˆmasterï¼‰**ï¼šå­˜å‚¨æ–‡ç« æºæ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€ä¸»é¢˜ç­‰å¼€å‘å†…å®¹
- **éƒ¨ç½²åˆ†æ”¯ï¼ˆgh-pagesï¼‰**ï¼šå­˜å‚¨Hexoç”Ÿæˆçš„é™æ€ç½‘ç«™æ–‡ä»¶
- **è‡ªåŠ¨åŒ–éƒ¨ç½²**ï¼šé€šè¿‡GitHub Actionså®ç°æ¨é€å³éƒ¨ç½²
- **å®‰å…¨ä¿éšœ**ï¼šé›¶åˆ é™¤æ“ä½œï¼Œå®Œæ•´ä¿ç•™å†å²è®°å½•

## ğŸ›¡ï¸ å®‰å…¨åŸåˆ™

1. **é›¶åˆ é™¤æ“ä½œ**ï¼šç»ä¸ä½¿ç”¨ä»»ä½•åˆ é™¤å‘½ä»¤
2. **å¤šé‡å¤‡ä»½**ï¼šæ“ä½œå‰è‡ªåŠ¨åˆ›å»ºGitæ ‡ç­¾å¤‡ä»½
3. **å¯é€†æ“ä½œ**ï¼šæ‰€æœ‰æ­¥éª¤éƒ½å¯ä»¥å›æ»š
4. **åˆ†æ­¥æ‰§è¡Œ**ï¼šæ¯ä¸ªæ­¥éª¤ç‹¬ç«‹éªŒè¯
5. **å®æ—¶æ—¥å¿—**ï¼šè¯¦ç»†è®°å½•æ‰€æœ‰æ“ä½œè¿‡ç¨‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é¢„è§ˆæ¨¡å¼ï¼ˆæ¨èå…ˆè¿è¡Œï¼‰

```bash
# é¢„è§ˆåˆ†æ”¯è®¾ç½®è¿‡ç¨‹ï¼ˆä¸æ‰§è¡Œå®é™…æ“ä½œï¼‰
npm run setup:preview

# é¢„è§ˆéƒ¨ç½²è¿‡ç¨‹
npm run deploy:preview
```

### 2. æ‰§è¡Œåˆ†æ”¯è®¾ç½®

```bash
# è®¾ç½®æºç ä¸éƒ¨ç½²åˆ†æ”¯åˆ†ç¦»
npm run setup:branches
```

### 3. æ—¥å¸¸å¼€å‘æµç¨‹

```bash
# 1. åœ¨masteråˆ†æ”¯è¿›è¡Œå¼€å‘
git checkout master

# 2. ç¼–å†™æ–‡ç« æˆ–ä¿®æ”¹é…ç½®
# ...

# 3. æäº¤æ›´æ”¹
git add .
git commit -m "feat: æ·»åŠ æ–°æ–‡ç« "
git push origin master

# 4. æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¯é€‰ï¼ŒGitHub Actionsä¼šè‡ªåŠ¨éƒ¨ç½²ï¼‰
npm run deploy:safe
```

## ğŸ“ åˆ†æ”¯ç»“æ„

### Masteråˆ†æ”¯ï¼ˆæºç ï¼‰
```
â”œâ”€â”€ source/              # æ–‡ç« æºæ–‡ä»¶
â”‚   â”œâ”€â”€ _posts/         # åšå®¢æ–‡ç« 
â”‚   â””â”€â”€ ...
â”œâ”€â”€ themes/             # ä¸»é¢˜æ–‡ä»¶
â”œâ”€â”€ _config.yml         # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ _config.stellar.yml # ä¸»é¢˜é…ç½®
â”œâ”€â”€ package.json        # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tools/              # å¼€å‘å·¥å…·
â”œâ”€â”€ .github/            # GitHubé…ç½®
â””â”€â”€ docs/              # æ–‡æ¡£
```

### gh-pagesåˆ†æ”¯ï¼ˆéƒ¨ç½²ï¼‰
```
â”œâ”€â”€ index.html         # ç”Ÿæˆçš„é¦–é¡µ
â”œâ”€â”€ archives/          # å½’æ¡£é¡µé¢
â”œâ”€â”€ categories/        # åˆ†ç±»é¡µé¢
â”œâ”€â”€ tags/             # æ ‡ç­¾é¡µé¢
â”œâ”€â”€ css/              # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ js/               # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ deploy-info.json  # éƒ¨ç½²ä¿¡æ¯
â””â”€â”€ README.md         # åˆ†æ”¯è¯´æ˜
```

## ğŸ”§ å·¥å…·è¯´æ˜

### 1. åˆ†æ”¯è®¾ç½®å·¥å…· (`tools/safe-branch-setup.js`)

**åŠŸèƒ½ï¼š**
- åˆ›å»ºå®‰å…¨å¤‡ä»½
- é…ç½®.gitignoreå¿½ç•¥ç”Ÿæˆæ–‡ä»¶
- ç§»é™¤ç”Ÿæˆæ–‡ä»¶çš„Gitè·Ÿè¸ªï¼ˆä¿ç•™æœ¬åœ°æ–‡ä»¶ï¼‰
- åˆ›å»ºå­¤ç«‹çš„gh-pagesåˆ†æ”¯
- è®¾ç½®GitHub Actionså·¥ä½œæµ

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# é¢„è§ˆæ¨¡å¼
npm run setup:preview

# å®é™…æ‰§è¡Œ
npm run setup:branches
```

### 2. å®‰å…¨éƒ¨ç½²å·¥å…· (`tools/safe-deploy.js`)

**åŠŸèƒ½ï¼š**
- æ„å»ºé™æ€ç½‘ç«™
- å®‰å…¨å¤åˆ¶æ–‡ä»¶åˆ°éƒ¨ç½²åˆ†æ”¯
- åˆ›å»ºéƒ¨ç½²æäº¤
- æ¨é€åˆ°è¿œç¨‹ä»“åº“

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# é¢„è§ˆæ¨¡å¼
npm run deploy:preview

# å®é™…éƒ¨ç½²
npm run deploy:safe

# å¼ºåˆ¶éƒ¨ç½²ï¼ˆè·³è¿‡æ£€æŸ¥ï¼‰
npm run deploy:safe -- --force
```

## âš™ï¸ GitHub Actionsè‡ªåŠ¨éƒ¨ç½²

è®¾ç½®å®Œæˆåï¼Œæ¯æ¬¡æ¨é€åˆ°masteråˆ†æ”¯éƒ½ä¼šè‡ªåŠ¨è§¦å‘éƒ¨ç½²ï¼š

```yaml
# .github/workflows/deploy.yml
name: éƒ¨ç½²åˆ°GitHub Pages

on:
  push:
    branches: [ master ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
      
    - name: è®¾ç½®Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        
    - name: å®‰è£…ä¾èµ–
      run: npm ci
      
    - name: æ„å»ºç½‘ç«™
      run: npm run build
      
    - name: éƒ¨ç½²åˆ°GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public
        publish_branch: gh-pages
```

## ğŸ“Š æ“ä½œæ—¥å¿—

æ‰€æœ‰å·¥å…·éƒ½ä¼šç”Ÿæˆè¯¦ç»†çš„æ“ä½œæ—¥å¿—ï¼š

- `branch-setup-TIMESTAMP.log` - åˆ†æ”¯è®¾ç½®æ—¥å¿—
- `deploy-TIMESTAMP.log` - éƒ¨ç½²æ“ä½œæ—¥å¿—
- `branch-setup-report-TIMESTAMP.json` - è®¾ç½®æŠ¥å‘Š
- `deploy-report-TIMESTAMP.json` - éƒ¨ç½²æŠ¥å‘Š

## ğŸ”„ å›æ»šæœºåˆ¶

### 1. ä½¿ç”¨å¤‡ä»½æ ‡ç­¾å›æ»š

```bash
# æŸ¥çœ‹å¤‡ä»½æ ‡ç­¾
git tag | grep backup

# å›æ»šåˆ°æŒ‡å®šå¤‡ä»½
git reset --hard backup-2025-12-28T10-30-00-000Z
```

### 2. åˆ é™¤é”™è¯¯çš„åˆ†æ”¯

```bash
# åˆ é™¤æœ¬åœ°gh-pagesåˆ†æ”¯
git branch -D gh-pages

# åˆ é™¤è¿œç¨‹gh-pagesåˆ†æ”¯
git push origin --delete gh-pages
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šç½‘ç«™æ˜¾ç¤º404é”™è¯¯

**åŸå› ï¼š** GitHub Pagesåˆ†æ”¯é…ç½®é”™è¯¯

**è§£å†³ï¼š**
1. è¿›å…¥GitHubä»“åº“è®¾ç½®
2. æ‰¾åˆ°Pagesè®¾ç½®
3. ç¡®è®¤Sourceè®¾ç½®ä¸º"Deploy from a branch"
4. é€‰æ‹©gh-pagesåˆ†æ”¯å’Œ/ (root)ç›®å½•

### é—®é¢˜2ï¼šæ ·å¼æ–‡ä»¶ä¸¢å¤±

**åŸå› ï¼š** é…ç½®æ–‡ä»¶ä¸­çš„URLè®¾ç½®é”™è¯¯

**è§£å†³ï¼š**
```yaml
# _config.yml
url: https://your-username.github.io/your-repo
root: /your-repo/
```

### é—®é¢˜3ï¼šGitHub Actionséƒ¨ç½²å¤±è´¥

**åŸå› ï¼š** æƒé™æˆ–é…ç½®é—®é¢˜

**è§£å†³ï¼š**
1. æ£€æŸ¥ä»“åº“çš„Actionsæƒé™è®¾ç½®
2. ç¡®è®¤GITHUB_TOKENæƒé™
3. æŸ¥çœ‹Actionsè¿è¡Œæ—¥å¿—

### é—®é¢˜4ï¼šæœ¬åœ°éƒ¨ç½²å·¥å…·å¤±è´¥

**åŸå› ï¼š** ç¯å¢ƒæˆ–ä¾èµ–é—®é¢˜

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥Node.jsç‰ˆæœ¬
node --version

# é‡æ–°å®‰è£…ä¾èµ–
npm ci

# æ¸…ç†å¹¶é‡æ–°æ„å»º
npm run clean && npm run build
```

## ğŸ“‹ æ£€æŸ¥æ¸…å•

### è®¾ç½®å®Œæˆåæ£€æŸ¥ï¼š

- [ ] masteråˆ†æ”¯åªåŒ…å«æºç æ–‡ä»¶
- [ ] gh-pagesåˆ†æ”¯åªåŒ…å«ç”Ÿæˆæ–‡ä»¶
- [ ] .gitignoreæ­£ç¡®é…ç½®
- [ ] GitHub Actionså·¥ä½œæµå­˜åœ¨
- [ ] å¤‡ä»½æ ‡ç­¾å·²åˆ›å»º
- [ ] è¿œç¨‹ä»“åº“åŒæ­¥æ­£å¸¸

### éƒ¨ç½²å®Œæˆåæ£€æŸ¥ï¼š

- [ ] ç½‘ç«™å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰é¡µé¢é“¾æ¥æ­£ç¡®
- [ ] æ ·å¼å’Œè„šæœ¬åŠ è½½æ­£å¸¸
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚æœå¯ç”¨ï¼‰
- [ ] è¯„è®ºç³»ç»Ÿæ­£å¸¸ï¼ˆå¦‚æœå¯ç”¨ï¼‰

## ğŸ”— ç›¸å…³èµ„æº

- [GitHub Pagesæ–‡æ¡£](https://docs.github.com/en/pages)
- [GitHub Actionsæ–‡æ¡£](https://docs.github.com/en/actions)
- [Hexoæ–‡æ¡£](https://hexo.io/docs/)
- [Stellarä¸»é¢˜æ–‡æ¡£](https://xaoxuu.com/wiki/stellar/)

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹æ“ä½œæ—¥å¿—æ–‡ä»¶
2. æ£€æŸ¥GitHub Actionsè¿è¡ŒçŠ¶æ€
3. å‚è€ƒæ•…éšœæ’é™¤éƒ¨åˆ†
4. ä½¿ç”¨å¤‡ä»½æ ‡ç­¾å›æ»š

---

**åˆ›å»ºæ—¶é—´ï¼š** 2025-12-28  
**ç‰ˆæœ¬ï¼š** 2.0  
**å®‰å…¨ç­‰çº§ï¼š** é«˜ï¼ˆé›¶åˆ é™¤æ“ä½œï¼‰